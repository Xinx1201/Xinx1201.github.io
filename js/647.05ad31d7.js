"use strict";(self["webpackChunkjx3_tool"]=self["webpackChunkjx3_tool"]||[]).push([[647],{1647:function(e,t,i){i.r(t),i.d(t,{default:function(){return D}});var o=function(){var e=this,t=e._self._c;return t("div",{staticClass:"container"},[t("div",{staticClass:"calc"},[t("div",{staticClass:"select"},[t("Operation",{on:{select:e.select}})],1),e.multipleSelection&&e.multipleSelection.length?t("div",{staticClass:"deleteAll"},[t("el-button",{on:{click:e.multipleDelet}},[e._v("删除")])],1):e._e(),t("div",{staticClass:"main"},[e.isChangeCurrentTime?[t("span",{staticClass:"customTime",on:{dblclick:e.onClickEdit}},[e._v(e._s(e.currentTime.split(" ")[0]))]),t("el-time-picker",{attrs:{"value-format":"HH:mm:ss",placeholder:"任意时间点"},model:{value:e.customTime,callback:function(t){e.customTime=t},expression:"customTime"}})]:t("span",{staticClass:"currentTime",on:{dblclick:e.onClickEdit}},[e._v(e._s(e.currentTime))]),t("span",{staticClass:"symbol"},[e._v("+")]),t("el-input-number",{attrs:{min:0,placeholder:"等待时间"},model:{value:e.intervalTime,callback:function(t){e.intervalTime=t},expression:"intervalTime"}}),t("span",{staticClass:"min"},[e._v("分钟")]),t("span",{staticClass:"symbol"},[e._v("=")]),[e.intervalTime?t("span",{staticClass:"endTime"},[e._v(e._s(e.endTime))]):t("span",{staticClass:"currentTime"},[e._v(e._s(e.currentTime))])]],2),t("div",{staticClass:"notify"},[t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"仅为当前页面时,可弹窗提示",placement:"top-start"}},[t("el-checkbox",{attrs:{disabled:!e.notifyPermission},on:{change:e.changeNotify},model:{value:e.notify,callback:function(t){e.notify=t},expression:"notify"}},[e._v("通知")])],1)],1),t("div",{staticClass:"record"},[t("el-button",{attrs:{type:"primary"},on:{click:e.onClickRecord}},[e._v("记录时间")])],1)]),t("div",{staticClass:"history"},[t("DataTable",{ref:"table",attrs:{tableData:e.tableData},on:{selection:e.selection}})],1)])},n=[],s=(i(7658),i(7484)),a=i.n(s),r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"operation"},[t("el-select",{staticClass:"mgl10",attrs:{filterable:"","default-first-option":"",placeholder:"请选择服务器"},on:{change:e.onSelectChange},model:{value:e.form.server,callback:function(t){e.$set(e.form,"server",t)},expression:"form.server"}},e._l(e.serverList,(function(i){return t("el-option-group",{key:i.zone,attrs:{label:i.zone}},e._l(i.options,(function(e){return t("el-option",{key:e.server,attrs:{label:e.server,value:e.server}})})),1)})),1),t("el-select",{attrs:{filterable:"",placeholder:"地图"},on:{change:e.onSelectChange},model:{value:e.form.map,callback:function(t){e.$set(e.form,"map",t)},expression:"form.map"}},e._l(e.horseMapOptions,(function(i){return t("el-option-group",{key:i.type,attrs:{label:i.type}},e._l(i.positions,(function(e){return t("el-option",{key:e.map,attrs:{label:e.map,value:e.map}})})),1)})),1),t("el-select",{attrs:{placeholder:"马驹类型"},on:{change:e.onSelectChange},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},e._l(e.defaultHorseOptions,(function(i){return t("el-option",{key:i,attrs:{label:i,value:i}},[t("span",{domProps:{innerHTML:e._s(e.$options.filters.filterKeyWord(i))}})])})),1)],1)},l=[],c=i(2325),m=JSON.parse('[{"type":"马场","positions":[{"map":"黑戈壁"},{"map":"鲲鹏岛"},{"map":"阴山大草原"}]},{"type":"大马","positions":[{"map":"昆仑"},{"map":"南屏山"},{"map":"白龙口"},{"map":"无量山"},{"map":"黑龙沼"}]},{"type":"小马","positions":[{"map":"金水镇"},{"map":"巴陵县"},{"map":"龙门荒漠"}]}]'),p=i(2067);const u=()=>({server:"破阵子",map:"",type:""});var f={name:"TimeOperation",data(){return{form:u(),serverList:p,horseMapOptions:m,defaultHorseOptions:["龙子/麟驹","绝尘/赤蛇/闪电","里飞沙","赤兔"],variationHorseOptions:{"鲲鹏岛":["龙子/麟驹(变异)","绝尘/赤蛇(变异)/闪电","里飞沙","赤兔"],"阴山大草原":["龙子/麟驹","绝尘(变异)/赤蛇/闪电","里飞沙","赤兔"],"黑戈壁":["龙子(变异)/麟驹","绝尘/赤蛇/闪电(变异)","里飞沙","赤兔"]}}},watch:{"form.map":{handler(e){this.horseMapOptions.find((e=>"马场"==e.type)).positions.some((t=>t.map==e))?(this.defaultHorseOptions=this.variationHorseOptions[e],this.form.type=""):this.horseMapOptions.find((e=>"小马"==e.type)).positions.some((t=>t.map==e))?(this.defaultHorseOptions=["龙子/麟驹","绝尘/赤蛇/闪电","里飞沙","赤兔"],this.form.type="龙子/麟驹"):"黑龙沼"==e?(this.defaultHorseOptions=["龙子/麟驹","绝尘/赤蛇/闪电","里飞沙","赤兔"],this.form.type="里飞沙"):this.horseMapOptions.find((e=>"大马"==e.type)).positions.some((t=>t.map==e))&&(this.defaultHorseOptions=["龙子/麟驹","绝尘/赤蛇/闪电","里飞沙","赤兔"],this.form.type="绝尘/赤蛇/闪电")}}},mounted(){this.onSelectChange()},methods:{onSelectChange(){this.$emit("select",this.form)}}},h=f,d=i(1001),v=(0,d.Z)(h,r,l,!1,null,"588530c2",null),y=v.exports,g=function(){var e=this,t=e._self._c;return t("div",{staticClass:"table"},[t("el-table",{staticStyle:{width:"100%",height:"100%"},attrs:{data:e.tableData,stripe:"",height:"73vh","cell-class-name":e.delLine},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"55"}}),t("el-table-column",{attrs:{prop:"recordTime",label:"记录时间",align:"center"}}),t("el-table-column",{attrs:{label:"区服",align:"center"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("span",[e._v(e._s(e.serverList.map((e=>e.options)).flat().find((e=>e.server==i.row.server)).zone))])]}}])}),t("el-table-column",{attrs:{prop:"server",label:"服务器",align:"center"}}),t("el-table-column",{attrs:{prop:"map",label:"地点",align:"center"}}),t("el-table-column",{attrs:{prop:"type",label:"类型",align:"center"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("span",{domProps:{innerHTML:e._s(e.$options.filters.filterKeyWord(i.row.type))}})]}}])}),t("el-table-column",{attrs:{prop:"endTime",label:"刷马时间",align:"center"},scopedSlots:e._u([{key:"default",fn:function(i){return[i.row.overTime?t("span",[e._v(e._s(i.row.endTime)),t("i",{staticClass:"danger"},[e._v("(已刷马)")])]):t("span",[e._v(e._s(i.row.endTime))])]}}])}),t("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-button",{staticClass:"mgr10",attrs:{size:"mini"},on:{click:function(t){return e.copy(i.row)}}},[e._v("复制")]),t("el-popconfirm",{attrs:{"confirm-button-text":"好的","cancel-button-text":"不用了",icon:"el-icon-info","icon-color":"red",title:"确定删除该条刷马信息？"},on:{confirm:function(t){return e.onDeletRecord(i.row)}}},[t("el-button",{attrs:{slot:"reference",size:"mini",type:"danger"},slot:"reference"},[e._v("删除")])],1)]}}])})],1)],1)},b=[],T=JSON.parse('["(◕ˇ∀ˇ◕)","(｡ì _ í｡)","_(•̀ω•́ 」∠)_","（￣⊿￣）","( ﹡ˆoˆ﹡ )","ヾ(✿ﾟ▽ﾟ)ノ","Ｏ(≧∇≦)Ｏ","(◕ˇ∀ˇ◕)","˗ˋˏ♡ˎˊ˗","๐˙Ⱉ˙๐","( * ´ ⌃`*)ゞ","（｡ò ∀ ó｡）","_(•̀ω•́ 」∠)_","ヾ(✿ﾟ▽ﾟ)ノ","(o^ ^o) /","(✩˙Ⱉ˙ฅ)","˙Ⱉ˙ฅ","(๑´∀`๑)","(๑•̀ㅂ•́)و✧","๑乛◡乛๑","(๑•́ ₃ •̀๑)","(๑¯Δ¯๑)","(๑\'ᴗ\'๑)","٩(๑>◡<๑)۶","乁(๑˙ϖ˙๑乁) ","ρʕ•̫͡•ʔϠ","d(ŐдŐ๑)","ε(*′･∀･｀)зﾞ","ฅ՞•ﻌ•՞ฅ","ヾ(✿ﾟ▽ﾟ)ノ","♡´･ᴗ･`♡","(๑`н´๑)","|•\'-\'•) ✧","( ˶ˆ꒳ˆ˵ )","۶•͈⚇•͈ა","૮₍ ˃ ⤙ ˂ ₎ა","(｡ì _ í｡)","°ʚ♡ɞ°","つ♡⊂"," ( * ´ ⌃`*)ゞ"]'),C={name:"HorseDataTable",props:{tableData:{type:Array,default:()=>[]}},data(){return{emoticons:T,serverList:p,multipleSelection:[]}},methods:{delLine({row:e,column:t,rowIndex:i,columnIndex:o}){if(5==e.overTime)return"del_line"},handleSelectionChange(e){this.multipleSelection=e,this.$emit("selection",this.multipleSelection)},randomInt(e,t){return Math.round(Math.random()*(t-e)+e)},copy(e){let t=this.emoticons[this.randomInt(0,this.emoticons.length)],i=document.createElement("input");i.value=`【${e.server}】将于${e.endTime.split(" ")[1]}在 ${e.map} 刷新马驹 ${e.type.split("/").join("\\")} ${t}`,document.body.appendChild(i),i.select(),document.execCommand("Copy"),this.$message.success("复制成功"),i.remove()},onDeletRecord(e){let t=this.tableData.findIndex((t=>t==e));this.tableData.splice(t,1)}}},_=C,w=(0,d.Z)(_,g,b,!1,null,"136be9ee",null),x=w.exports,S=JSON.parse('{"麟驹":"https://icon.jx3box.com/icon/1897.png","麟驹(变异)":"https://icon.jx3box.com/icon/1897.png","龙子":"https://icon.jx3box.com/icon/1897.png","龙子(变异)":"https://icon.jx3box.com/icon/1897.png","绝尘":"https://icon.jx3box.com/icon/1894.png","绝尘(变异)":"https://icon.jx3box.com/icon/1894.png","赤蛇":"https://icon.jx3box.com/icon/1895.png","赤蛇(变异)":"https://icon.jx3box.com/icon/1895.png","闪电":"https://icon.jx3box.com/icon/1897.png","闪电(变异)":"https://icon.jx3box.com/icon/1897.png","里飞沙":"https://icon.jx3box.com/icon/1898.png","赤兔":"https://icon.jx3box.com/icon/5991.png"}'),k={name:"Time",components:{Operation:y,DataTable:x},data(){return{form:{},tableData:[],currentTime:"",intervalTime:"",endTime:"",customTime:"",customcurrentTime:"",isChangeCurrentTime:!1,notify:!1,notifyPermission:null,multipleSelection:[]}},watch:{customTime:{handler(e){this.customcurrentTime=this.currentTime.split(" ")[0]+" "+e}},intervalTime:{handler(e){let t=this.isChangeCurrentTime?a()(this.customcurrentTime).valueOf():a()().valueOf(),i=60*this.intervalTime*1e3,o=t+i;this.endTime=(0,c.UW)(o,"datetime")},immediate:!0},currentTime:{handler(e){let t=JSON.parse(JSON.stringify(this.tableData)),i=a()().valueOf(),o=300,n=600;t.forEach((e=>{let s=a()(e.endTime).valueOf(),r=a()(s).diff(i,"second"),l=e.type.split("/"),m=e.type.split("/").length;this.notify&&(r==n?new Notification("准备刷马",{body:`【${e.server}】的【${e.map}】将于10分钟后开始刷->${e.type}`,icon:`${S[l[(0,c.Iy)(0,m-1)]]}`}):r==o&&new Notification("已经刷马",{body:`【${e.server}】的【${e.map}】将于5分钟后开始刷->${e.type}`,icon:`${S[l[(0,c.Iy)(0,m-1)]]}`}));let p=a()(i).diff(s,"second");if(p==o)t.find((t=>t==e)).overTime=5,this.tableData=t;else if(p>=n){let i=t.findIndex((t=>t==e));t.splice(i,1),this.tableData=t}}))}},tableData:{handler(e){window.localStorage.setItem("timeData",JSON.stringify(e))}}},created(){this.currentTime=(0,c.UW)(a()().valueOf(),"datetime")},mounted(){this.checkNotifyPermission(),clearInterval(this.timer),this.timer=setInterval((()=>{this.currentTime=(0,c.UW)(a()().valueOf(),"datetime")}),1e3),window.localStorage.getItem("notify")&&(this.notify=JSON.parse(window.localStorage.getItem("notify"))),window.localStorage.getItem("notifyPermission")&&(this.notifyPermission=JSON.parse(window.localStorage.getItem("notifyPermission"))),window.localStorage.getItem("timeData")&&(this.tableData=JSON.parse(window.localStorage.getItem("timeData")))},beforeDestroy(){clearInterval(this.timer)},methods:{select(e){this.form=e},onClickEdit(){this.isChangeCurrentTime=!this.isChangeCurrentTime},selection(e){this.multipleSelection=e},multipleDelet(){this.$confirm("此操作将删除信息, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.multipleSelection.forEach((e=>{let t=this.tableData.findIndex((t=>t==e));this.tableData.splice(t,1)})),this.$message({type:"success",message:"删除成功!"})})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))},onClickRecord(){this.intervalTime="",this.tableData.push({recordTime:this.isChangeCurrentTime?this.customcurrentTime:this.currentTime,server:this.form.server,map:this.form.map,type:this.form.type,endTime:this.endTime}),this.isChangeCurrentTime=!1},changeNotify(){window.localStorage.setItem("notify",this.notify)},checkNotifyPermission(){window.Notification?"granted"==Notification.permission?(console.log("允许通知"),this.notifyPermission=!0,window.localStorage.setItem("notifyPermission",!0)):"denied"!=Notification.permission?(console.log("需要通知权限"),Notification.requestPermission((e=>{console.log(e),"denied"==e?(this.notifyPermission=!1,window.localStorage.setItem("notifyPermission",!1)):(this.notify=!0,window.localStorage.setItem("notify",!0),this.notifyPermission=!0,window.localStorage.setItem("notifyPermission",!0))}))):"denied"==Notification.permission&&(this.notify=!1,window.localStorage.setItem("notify",!1),this.notifyPermission=!1,window.localStorage.setItem("notifyPermission",!1)):console.error("浏览器不支持Notification")}}},O=k,z=(0,d.Z)(O,o,n,!1,null,"1681ba4c",null),D=z.exports},2067:function(e){e.exports=JSON.parse('[{"zone":"双线一区","options":[{"zone":"双线一区","server":"破阵子"},{"zone":"双线一区","server":"天鹅坪"}]},{"zone":"电信一区","options":[{"zone":"电信一区","server":"长安城"},{"zone":"电信一区","server":"龙争虎斗"},{"zone":"电信一区","server":"蝶恋花"}]},{"zone":"电信五区","options":[{"zone":"电信五区","server":"剑胆琴心"},{"zone":"电信五区","server":"幽月轮"},{"zone":"电信五区","server":"乾坤一掷"},{"zone":"电信五区","server":"斗转星移"},{"zone":"电信五区","server":"唯我独尊"},{"zone":"电信五区","server":"梦江南"},{"zone":"电信五区","server":"横刀断浪"}]},{"zone":"电信八区","options":[{"zone":"电信八区","server":"绝代天骄"}]},{"zone":"双线二区","options":[{"zone":"双线二区","server":"飞龙在天"}]},{"zone":"双线四区","options":[{"zone":"双线四区","server":"青梅煮酒"}]}]')}}]);